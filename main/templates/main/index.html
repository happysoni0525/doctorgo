{% extends 'base.html' %}
{% load static %}

{% block style %}

{% endblock %}

{% block content%}

<div class="hero" style="background-image: url('../../../static/images/doctor1920.jpg');">

    <div class="container">
        <div class="row align-items-center justify-content-center">
            <div class="col-lg-10">

                <div class="row mb-5">
                    <div class="col-lg-7 intro">
                        <h1><strong>당신을 위한 명의를 </strong> <br>찾아드립니다.</h1>
                    </div>
                </div>

                <form class="trip-form" id="go_form">

                    <div class="row align-items-center">

                        <div class="mb-3 mb-md-0 col-md-3">
                            <select name="" id="city" class="custom-select form-control">
                                <option value="">지역</option>
                                <!-- <a href='/main/?area=seoul'><option value="">서울</option></a> -->
                            </select>
                        </div>
                        <div class="mb-3 mb-md-0 col-md-3">
                            <select name="" id="hospital" class="custom-select form-control">
                                <option value="">병원명</option>
                                <option value="">지역을 먼저 선택하세요.</option>
                            </select>
                        </div>
                        <div class="mb-3 mb-md-0 col-md-3">
                            <select name="" id="subjects" class="custom-select form-control">
                                <option value="">진료과목</option>
                                <option value="">병원을 먼저 선택하세요.</option>
                            </select>
                        </div>
                        <div class="mb-3 mb-md-0 col-md-3">
                            <input type="submit" class="btn btn-primary btn-block py-3" value="Go!" onclick="click_go()">
                        </div>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>

<!-- 

<div class="site-section">
    <div class="container">
        <h2 class="section-heading"><strong>How it works?</strong></h2>
        <p class="mb-5">Easy steps to get you started</p>

        <div class="row mb-5">
            <div class="col-lg-4 mb-4 mb-lg-0">
                <div class="step">
                    <span>1</span>
                    <div class="step-inner">
                        <span class="number text-primary">01.</span>
                        <h3>Select a car</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Vero, laboriosam!</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-4 mb-lg-0">
                <div class="step">
                    <span>2</span>
                    <div class="step-inner">
                        <span class="number text-primary">02.</span>
                        <h3>Fill up form</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Vero, laboriosam!</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-4 mb-lg-0">
                <div class="step">
                    <span>3</span>
                    <div class="step-inner">
                        <span class="number text-primary">03.</span>
                        <h3>Payment</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Vero, laboriosam!</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-4 mx-auto">
                <a href="#" class="d-flex align-items-center play-now mx-auto">
                    <span class="icon">
                        <span class="icon-play"></span>
                    </span>
                    <span class="caption">Video how it works</span>
                </a>
            </div>
        </div>
    </div>
</div>

<div class="site-section">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-7 text-center order-lg-2">
                <div class="img-wrap-1 mb-5">
                    <img src='{% static "images/feature_01.png" %}' alt="Image" class="img-fluid">
                </div>
            </div>
            <div class="col-lg-4 ml-auto order-lg-1">
                <h3 class="mb-4 section-heading"><strong>You can easily avail our promo for renting a car.</strong>
                </h3>
                <p class="mb-5">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Repudiandae, explicabo
                    iste a labore id est quas, doloremque veritatis! Provident odit pariatur dolorem quisquam,
                    voluptatibus voluptates optio accusamus, vel quasi quidem!</p>

                <p><a href="#" class="btn btn-primary">Meet them now</a></p>
            </div>
        </div>
    </div>
</div>



<div class="site-section bg-light">
    <div class="container">
        <div class="row">
            <div class="col-lg-7">
                <h2 class="section-heading"><strong>Car Listings</strong></h2>
                <p class="mb-5">Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
            </div>
        </div>


        <div class="row">
            <div class="col-md-6 col-lg-4 mb-4">

                <div class="listing d-block  align-items-stretch">
                    <div class="listing-img h-100 mr-4">
                        <img src='{% static "images/car_6.jpg" %}' alt="Image" class="img-fluid">
                    </div>
                    <div class="listing-contents h-100">
                        <h3>Mitsubishi Pajero</h3>
                        <div class="rent-price">
                            <strong>$389.00</strong><span class="mx-1">/</span>day
                        </div>
                        <div class="d-block d-md-flex mb-3 border-bottom pb-3">
                            <div class="listing-feature pr-4">
                                <span class="caption">Luggage:</span>
                                <span class="number">8</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Doors:</span>
                                <span class="number">4</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Passenger:</span>
                                <span class="number">4</span>
                            </div>
                        </div>
                        <div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quos eos at eum, voluptatem
                                quibusdam.</p>
                            <p><a href="#" class="btn btn-primary btn-sm">Rent Now</a></p>
                        </div>
                    </div>

                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-4">

                <div class="listing d-block  align-items-stretch">
                    <div class="listing-img h-100 mr-4">
                        <img src='{% static "images/car_5.jpg" %}' alt="Image" class="img-fluid">
                    </div>
                    <div class="listing-contents h-100">
                        <h3>Nissan Moco</h3>
                        <div class="rent-price">
                            <strong>$389.00</strong><span class="mx-1">/</span>day
                        </div>
                        <div class="d-block d-md-flex mb-3 border-bottom pb-3">
                            <div class="listing-feature pr-4">
                                <span class="caption">Luggage:</span>
                                <span class="number">8</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Doors:</span>
                                <span class="number">4</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Passenger:</span>
                                <span class="number">4</span>
                            </div>
                        </div>
                        <div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quos eos at eum, voluptatem
                                quibusdam.</p>
                            <p><a href="#" class="btn btn-primary btn-sm">Rent Now</a></p>
                        </div>
                    </div>

                </div>
            </div>


            <div class="col-md-6 col-lg-4 mb-4">

                <div class="listing d-block  align-items-stretch">
                    <div class="listing-img h-100 mr-4">
                        <img src='{% static "images/car_4.jpg" %}' alt="Image" class="img-fluid">
                    </div>
                    <div class="listing-contents h-100">
                        <h3>Honda Fitta</h3>
                        <div class="rent-price">
                            <strong>$389.00</strong><span class="mx-1">/</span>day
                        </div>
                        <div class="d-block d-md-flex mb-3 border-bottom pb-3">
                            <div class="listing-feature pr-4">
                                <span class="caption">Luggage:</span>
                                <span class="number">8</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Doors:</span>
                                <span class="number">4</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Passenger:</span>
                                <span class="number">4</span>
                            </div>
                        </div>
                        <div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quos eos at eum, voluptatem
                                quibusdam.</p>
                            <p><a href="#" class="btn btn-primary btn-sm">Rent Now</a></p>
                        </div>
                    </div>

                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-4">

                <div class="listing d-block  align-items-stretch">
                    <div class="listing-img h-100 mr-4">
                        <img src='{% static "images/car_3.jpg" %}' alt="Image" class="img-fluid">
                    </div>
                    <div class="listing-contents h-100">
                        <h3>Skoda Laura</h3>
                        <div class="rent-price">
                            <strong>$389.00</strong><span class="mx-1">/</span>day
                        </div>
                        <div class="d-block d-md-flex mb-3 border-bottom pb-3">
                            <div class="listing-feature pr-4">
                                <span class="caption">Luggage:</span>
                                <span class="number">8</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Doors:</span>
                                <span class="number">4</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Passenger:</span>
                                <span class="number">4</span>
                            </div>
                        </div>
                        <div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quos eos at eum, voluptatem
                                quibusdam.</p>
                            <p><a href="#" class="btn btn-primary btn-sm">Rent Now</a></p>
                        </div>
                    </div>

                </div>
            </div>

            <div class="col-md-6 col-lg-4 mb-4">

                <div class="listing d-block  align-items-stretch">
                    <div class="listing-img h-100 mr-4">
                        <img src='{% static "images/car_2.jpg" %}' alt="Image" class="img-fluid">
                    </div>
                    <div class="listing-contents h-100">
                        <h3>Mazda LaPuta</h3>
                        <div class="rent-price">
                            <strong>$389.00</strong><span class="mx-1">/</span>day
                        </div>
                        <div class="d-block d-md-flex mb-3 border-bottom pb-3">
                            <div class="listing-feature pr-4">
                                <span class="caption">Luggage:</span>
                                <span class="number">8</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Doors:</span>
                                <span class="number">4</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Passenger:</span>
                                <span class="number">4</span>
                            </div>
                        </div>
                        <div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quos eos at eum, voluptatem
                                quibusdam.</p>
                            <p><a href="#" class="btn btn-primary btn-sm">Rent Now</a></p>
                        </div>
                    </div>

                </div>
            </div>


            <div class="col-md-6 col-lg-4 mb-4">

                <div class="listing d-block  align-items-stretch">
                    <div class="listing-img h-100 mr-4">
                        <img src='{%static "images/car_1.jpg" %}' alt="Image" class="img-fluid">
                    </div>
                    <div class="listing-contents h-100">
                        <h3>Buick LaCrosse</h3>
                        <div class="rent-price">
                            <strong>$389.00</strong><span class="mx-1">/</span>day
                        </div>
                        <div class="d-block d-md-flex mb-3 border-bottom pb-3">
                            <div class="listing-feature pr-4">
                                <span class="caption">Luggage:</span>
                                <span class="number">8</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Doors:</span>
                                <span class="number">4</span>
                            </div>
                            <div class="listing-feature pr-4">
                                <span class="caption">Passenger:</span>
                                <span class="number">4</span>
                            </div>
                        </div>
                        <div>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Quos eos at eum, voluptatem
                                quibusdam.</p>
                            <p><a href="#" class="btn btn-primary btn-sm">Rent Now</a></p>
                        </div>
                    </div>

                </div>
            </div>

        </div>
    </div>
</div>

<div class="site-section">
    <div class="container">
        <div class="row">
            <div class="col-lg-7">
                <h2 class="section-heading"><strong>Features</strong></h2>
                <p class="mb-5">Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
            </div>
        </div>

        <div class="row">
            <div class="col-lg-4 mb-5">
                <div class="service-1 dark">
                    <span class="service-1-icon">
                        <span class="icon-home"></span>
                    </span>
                    <div class="service-1-contents">
                        <h3>Lorem ipsum dolor</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Obcaecati, laboriosam.</p>
                        <p class="mb-0"><a href="#">Learn more</a></p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-5">
                <div class="service-1 dark">
                    <span class="service-1-icon">
                        <span class="icon-gear"></span>
                    </span>
                    <div class="service-1-contents">
                        <h3>Lorem ipsum dolor</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Obcaecati, laboriosam.</p>
                        <p class="mb-0"><a href="#">Learn more</a></p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-5">
                <div class="service-1 dark">
                    <span class="service-1-icon">
                        <span class="icon-watch_later"></span>
                    </span>
                    <div class="service-1-contents">
                        <h3>Lorem ipsum dolor</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Obcaecati, laboriosam.</p>
                        <p class="mb-0"><a href="#">Learn more</a></p>
                    </div>
                </div>
            </div>

            <div class="col-lg-4 mb-5">
                <div class="service-1 dark">
                    <span class="service-1-icon">
                        <span class="icon-verified_user"></span>
                    </span>
                    <div class="service-1-contents">
                        <h3>Lorem ipsum dolor</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Obcaecati, laboriosam.</p>
                        <p class="mb-0"><a href="#">Learn more</a></p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-5">
                <div class="service-1 dark">
                    <span class="service-1-icon">
                        <span class="icon-video_library"></span>
                    </span>
                    <div class="service-1-contents">
                        <h3>Lorem ipsum dolor</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Obcaecati, laboriosam.</p>
                        <p class="mb-0"><a href="#">Learn more</a></p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-5">
                <div class="service-1 dark">
                    <span class="service-1-icon">
                        <span class="icon-vpn_key"></span>
                    </span>
                    <div class="service-1-contents">
                        <h3>Lorem ipsum dolor</h3>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Obcaecati, laboriosam.</p>
                        <p class="mb-0"><a href="#">Learn more</a></p>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

<div class="site-section bg-light">
    <div class="container">
        <div class="row">
            <div class="col-lg-7">
                <h2 class="section-heading"><strong>Testimonials</strong></h2>
                <p class="mb-5">Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
            </div>
        </div>
        <div class="row">
            <div class="col-lg-4 mb-4 mb-lg-0">
                <div class="testimonial-2">
                    <blockquote class="mb-4">
                        <p>"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptatem, deserunt eveniet
                            veniam. Ipsam, nam, voluptatum"</p>
                    </blockquote>
                    <div class="d-flex v-card align-items-center">
                        <img src='{% static "images/person_1.jpg" %}' alt="Image" class="img-fluid mr-3">
                        <div class="author-name">
                            <span class="d-block">Mike Fisher</span>
                            <span>Owner, Ford</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-4 mb-lg-0">
                <div class="testimonial-2">
                    <blockquote class="mb-4">
                        <p>"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptatem, deserunt eveniet
                            veniam. Ipsam, nam, voluptatum"</p>
                    </blockquote>
                    <div class="d-flex v-card align-items-center">
                        <img src='{% static "images/person_2.jpg" %}' alt="Image" class="img-fluid mr-3">
                        <div class="author-name">
                            <span class="d-block">Jean Stanley</span>
                            <span>Traveler</span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-4 mb-4 mb-lg-0">
                <div class="testimonial-2">
                    <blockquote class="mb-4">
                        <p>"Lorem ipsum dolor sit amet, consectetur adipisicing elit. Voluptatem, deserunt eveniet
                            veniam. Ipsam, nam, voluptatum"</p>
                    </blockquote>
                    <div class="d-flex v-card align-items-center">
                        <img src='{% static "images/person_3.jpg" %}' alt="Image" class="img-fluid mr-3">
                        <div class="author-name">
                            <span class="d-block">Katie Rose</span>
                            <span>Customer</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div class="site-section bg-primary py-5">
    <div class="container">
        <div class="row align-items-center">
            <div class="col-lg-7 mb-4 mb-md-0">
                <h2 class="mb-0 text-white">What are you waiting for?</h2>
                <p class="mb-0 opa-7">Lorem ipsum dolor sit amet, consectetur adipisicing elit. Obcaecati,
                    laboriosam.</p>
            </div>
            <div class="col-lg-5 text-md-right">
                <a href="#" class="btn btn-primary btn-white">Rent a car now</a>
            </div>
        </div>
    </div>
</div> -->


<script>
    //처음 페이지 로드시 ajax request get 도시명 
    $.ajax({
        type: "GET",
        url: 'cities',
        data: {},
        success: function (response) {
            console.log(response)
            add_city('전체지역');
            for (let i = 0; i < response.length; i++) {
                add_city(response[i]['city']);
            }
        },
        error: function (error) {
            console.log("Request Get Failed")
        }
    })

    function add_city(city) {
        // let temp_html = '<option val=' + '"' + i + '"' + '>' + location + '</option>';
        let temp_html = '<option>' + city + '</option>';
        console.log(temp_html)
        $('#city').append(temp_html);
    }



    //도시명 선택시 request get 병원명
    $("select[id=city]").change(function () {
        city = $(this).val();
        console.log(city); //value값 가져오기

        // console.log($("select[id=location] option:selected").text()); //text값 가져오기
        get_hospital_list(city)
        $('#subjects').html('')
        $('#subjects').append('<option>진료과목</option>');
        $('#subjects').append('<option>병원을 먼저 선택하세요.</option>');
    });

    function get_hospital_list(city) {
        if (city == "") {
            $('#hospital').html('')
            $('#hospital').append('<option>병원명</option>');
            $('#hospital').append('<option>지역을 먼저 선택하세요.</option>');
            return console.log("Not Selected")
        }
        let target_url = 'cities/'+ city + '/hospitals'
        $.ajax({
            type: "GET",
            url: target_url,
            data: {},
            success: function (response) {
                console.log(response)
                $('#hospital').html('')
                $('#hospital').append("'<option>병원명</option>");
                add_hospital('all','전체병원');
                for (let i = 0; i < response.length; i++) {
                    add_hospital(response[i]['id'], response[i]['hospital_name']);
                }
            },
            error: function (error) {
                console.log("Request Get Failed")
            }
        })
    }

    function add_hospital(hospital_id, hospital_name) {
        let temp_html = '<option value='  + hospital_id + '>' + hospital_name + '</option>';
        // let temp_html = '<option>' + hospital + '</option>';
        console.log(temp_html)
        $('#hospital').append(temp_html);
    }


    //병원명 선택시 request get 진료과목

    $("select[id=hospital]").change(function () {
        // hospital_name = $(this).val();
        // console.log(hospital_name); //value값 가져오기
        // console.log($("select[id=hospital] option:selected").val()); //text값 가져오기
        let city_name=$("#city option:selected").text()
        console.log(city)
        let hospital_id=$("#hospital option:selected").val()
        console.log(hospital_id)
        get_subjects_list(city_name, hospital_id)
    });

    function get_subjects_list(city_name, hospital_id) {
        if ((hospital_id == "") || (hospital_id == "all")) {
            $('#subjects').html('')
            $('#subjects').append('<option>진료과목</option>');
            $('#subjects').append('<option>병원을 먼저 선택하세요.</option>');
            return 0
        }
        let target_url = 'cities/' + city_name+ '/hospitals/' + hospital_id + '/subjects'
        $.ajax({
            type: "GET",
            url: target_url,
            data: {},
            success: function (response) {
                console.log(response)
                $('#subjects').html('')
                $('#subjects').append("<option>진료과목</option>");
                add_subjects('all','전체진료과목');
                for (let i = 0; i < response.length; i++) {
                    add_subjects(response[i]['id'], response[i]['subjects_name']);
                }
            },
            error: function (error) {
                console.log("Request Get Failed")
            }
        })
    }

    function add_subjects(subjects_id, subjects_name) {
        let temp_html = '<option value=' + subjects_id + '>' + subjects_name + '</option>';
        // let temp_html = '<option>' + subjects + '</option>';
        console.log(temp_html)
        $('#subjects').append(temp_html);
    }

// request get main/about/진료과목코드
    function click_go(){
        let city_name = $("#city option:selected").val()
        let hospital_id = $("#hospital option:selected").val()
        let subejcts_id = $("#subjects option:selected").val()
        if (city_name){
                console.log(city_name)
                let target_url="listing/cities/"+city_name+"/hospitals"
        $('#go_form').attr("action",target_url)
        $('#go_form').attr("method","get")
        $('#go_form').submit()
        
        }
        else if(hospital_id){
            console.log(hospital_id)
            let target_url="listing/"+subejcts_id
        $('#go_form').attr("action",target_url)
        $('#go_form').attr("method","get")
        $('#go_form').submit()
        }
        else if(subejcts_id){
            console.log(subejcts_id)
            let target_url="about/"+subejcts_id
        $('#go_form').attr("action",target_url)
        $('#go_form').attr("method","get")
        $('#go_form').submit()
        }
        console.log(city_name)
        console.log(hospital_id)
        console.log(subejcts_id)
    }

</script>




{% endblock %}